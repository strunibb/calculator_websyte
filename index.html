<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Онлайн школа "Струны Будущего"</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #7e22ce;
            --secondary: #3b82f6;
            --accent: #ec4899;
            --dark: #1e293b;
            --light: #f8fafc;
        }

        body {
            font-family: 'Manrope', sans-serif;
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: var(--light);
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
        }

        .gradient-text {
            background: linear-gradient(90deg, var(--accent), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--accent));
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.6);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .teacher-card:hover .teacher-img {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .modal-overlay {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .modal-content {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            animation: modalEnter 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modalEnter {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(236, 72, 153, 0); }
            100% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0); }
        }

        .video-thumbnail {
            transition: all 0.3s ease;
        }

        .video-thumbnail:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .subscription-card {
            transition: all 0.3s ease;
        }

        .subscription-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .counter-btn {
            transition: all 0.2s ease;
        }

        .counter-btn:hover {
            transform: scale(1.1);
        }

        input:focus, select:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.3);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        @media (max-width: 640px) {
            .teacher-img {
                width: 120px;
                height: 120px;
            }
        }
    </style>
</head>
<body class="antialiased">
    <!-- Floating music notes -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none z-0">
        <div class="absolute top-1/4 left-1/4 text-4xl text-purple-400 opacity-20 animate-bounce">♪</div>
        <div class="absolute top-1/3 right-1/5 text-3xl text-pink-400 opacity-30 animate-bounce delay-100">♫</div>
        <div class="absolute bottom-1/4 left-1/5 text-5xl text-blue-400 opacity-25 animate-bounce delay-200">♩</div>
        <div class="absolute bottom-1/3 right-1/4 text-2xl text-indigo-400 opacity-40 animate-bounce delay-300">♬</div>
    </div>

    <div class="container mx-auto px-4 py-8 relative z-10">
        <!-- Header -->
        <header class="text-center mb-16 animate__animated animate__fadeIn">
            <div class="glass-card rounded-2xl p-8 inline-block">
                <h1 class="text-4xl md:text-5xl font-extrabold mb-4 gradient-text">
                    <i class="fas fa-guitar mr-3"></i>Струны Будущего
                </h1>
                <p class="text-xl text-gray-300 max-w-2xl mx-auto">
                    Раскрой свой музыкальный потенциал с лучшими преподавателями онлайн
                </p>
            </div>
        </header>

        <!-- Teachers Section -->
        <section class="mb-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-white mb-4 relative inline-block">
                    Наши преподаватели
                    <span class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full"></span>
                </h2>
                <p class="text-gray-400 max-w-2xl mx-auto">
                    Профессионалы с многолетним опытом преподавания и выступлений
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Мария -->
                <div class="teacher-card glass-card rounded-xl p-6 text-center transition-all duration-300 hover:bg-opacity-20">
                    <div class="relative mx-auto w-40 h-40 mb-6 overflow-hidden rounded-full border-4 border-white border-opacity-10">
                        <img src="images/maria.jpg" 
                             alt="Мария" 
                             class="teacher-img w-full h-full object-cover transition-transform duration-300">
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-2">Мария</h3>
                    <p class="text-purple-300 mb-1"><i class="fas fa-guitar mr-2"></i>Гитара</p>
                    <p class="text-gray-400"><i class="fas fa-clock mr-2"></i>Стаж: 5 лет</p>
                </div>

                <!-- Никита -->
                <div class="teacher-card glass-card rounded-xl p-6 text-center transition-all duration-300 hover:bg-opacity-20">
                    <div class="relative mx-auto w-40 h-40 mb-6 overflow-hidden rounded-full border-4 border-white border-opacity-10">
                        <img src="images/nikita.jpg"
                             alt="Никита" 
                             class="teacher-img w-full h-full object-cover transition-transform duration-300">
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-2">Никита</h3>
                    <p class="text-purple-300 mb-1"><i class="fas fa-guitar mr-2"></i>Гитара, Электрогитара, Укулеле</p>
                    <p class="text-gray-400"><i class="fas fa-clock mr-2"></i>Стаж: 8 лет</p>
                </div>

                <!-- Ксения -->
                <div class="teacher-card glass-card rounded-xl p-6 text-center transition-all duration-300 hover:bg-opacity-20">
                    <div class="relative mx-auto w-40 h-40 mb-6 overflow-hidden rounded-full border-4 border-white border-opacity-10">
                        <img src=images/ksenia.jpg
                             alt="Ксения" 
                             class="teacher-img w-full h-full object-cover transition-transform duration-300">
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-2">Ксения</h3>
                    <p class="text-purple-300 mb-1"><i class="fas fa-microphone mr-2"></i>Вокал</p>
                    <p class="text-gray-400"><i class="fas fa-clock mr-2"></i>Стаж: 6 лет</p>
                </div>
            </div>
        </section>
        
                <section class="mb-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-white mb-4 relative inline-block">
                    <br>
                    <i class="fas fa-tags mr-3"></i>Посмотрите, каких результатов достигают наши ученики всего за несколько месяцев
                    <span class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full"></span>
                </h2>
                <p class="text-gray-400 max-w-2xl mx-auto">
                    Гибкие варианты обучения для любого уровня и бюджета
                </p>
            </div>

        <!-- Student Videos Section -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student1-preview.jpg">
                    <source src="videos/student1.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student2-preview.jpg">
                    <source src="videos/student2.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student3-preview.jpg">
                    <source src="videos/student3.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student4-preview.jpg">
                    <source src="videos/student4.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student5-preview.jpg">
                    <source src="videos/student5.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student6-preview.jpg">
                    <source src="videos/student6.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student7-preview.jpg">
                    <source src="videos/student7.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student8-preview.jpg">
                    <source src="videos/student8.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
                <video class="w-full rounded-xl shadow-lg aspect-video" controls poster="images/student9-preview.jpg">
                    <source src="videos/student9.mp4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="mb-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-white mb-4 relative inline-block">
                    <br>
                    <br>
                    <i class="fas fa-tags mr-3"></i>Выберите абонемент
                    <span class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full"></span>
                </h2>
                <p class="text-gray-400 max-w-2xl mx-auto">
                    Гибкие варианты обучения для любого уровня и бюджета
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Личный на 1 месяц -->
                <div class="subscription-card bg-gradient-to-br from-purple-900 to-indigo-900 rounded-xl p-6 cursor-pointer"
                     onclick="handleSubscriptionSelect('personal1')">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-white">Личный на 1 месяц</h3>
                        <span class="bg-purple-600 text-white text-xs font-bold px-2 py-1 rounded-full">Популярный</span>
                    </div>
                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-purple-400 mr-2"></i>
                            <span>4 занятия - 3.690₽ (922р/урок)</span>
                        </li>
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-purple-400 mr-2"></i>
                            <span>6 занятий - 5.290₽ (881р/урок)</span>
                        </li>
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-purple-400 mr-2"></i>
                            <span>8 занятий - 6.890₽ (861р/урок)</span>
                        </li>
                    </ul>
                    <button class="w-full btn-primary py-3 rounded-lg font-semibold">
                        Выбрать <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>

                <!-- Личный на 2 месяца -->
                <div class="subscription-card bg-gradient-to-br from-blue-900 to-indigo-900 rounded-xl p-6 cursor-pointer"
                     onclick="handleSubscriptionSelect('personal3')">
                    <h3 class="text-xl font-bold text-white mb-4">Личный на 2 месяца</h3>
                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-blue-400 mr-2"></i>
                            <span>8 занятий - 7.190₽ (898р/урок)</span>
                        </li>
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-blue-400 mr-2"></i>
                            <span>12 занятий - 10.490₽ (874р/урок)</span>
                        </li>
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-blue-400 mr-2"></i>
                            <span>16 занятий - 13.590₽ (849р/урок)</span>
                        </li>
                    </ul>
                    <button class="w-full btn-primary py-3 rounded-lg font-semibold">
                        Выбрать <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>

                <!-- Парный абонемент -->
                <div class="subscription-card bg-gradient-to-br from-pink-900 to-purple-900 rounded-xl p-6 cursor-pointer"
                     onclick="handleSubscriptionSelect('pair')">
                    <h3 class="text-xl font-bold text-white mb-4">Парный абонемент</h3>
                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-pink-400 mr-2"></i>
                            <span>3 парных + 1 личное занятие</span>
                        </li>
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-pink-400 mr-2"></i>
                            <span>Экономия до 30%</span>
                        </li>
                    </ul>
                    <div class="text-2xl font-bold text-white mb-4">2.490₽</div>
                    <button class="w-full btn-primary py-3 rounded-lg font-semibold">
                        Выбрать <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>

                <!-- Комбо абонемент -->
                <div class="subscription-card bg-gradient-to-br from-indigo-900 to-blue-900 rounded-xl p-6 cursor-pointer"
                     onclick="handleSubscriptionSelect('combo')">
                    <h3 class="text-xl font-bold text-white mb-4">Комбо абонемент</h3>
                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-indigo-400 mr-2"></i>
                            <span>Занятия с разными преподавателями</span>
                        </li>
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-indigo-400 mr-2"></i>
                            <span>Гибкий график</span>
                        </li>
                    </ul>
                    <div class="text-xl font-bold text-white mb-4">от 2.990₽ до 6.380₽</div>
                    <button class="w-full btn-primary py-3 rounded-lg font-semibold">
                        Выбрать <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>

                <!-- Видеокурс -->
                <div class="subscription-card bg-gradient-to-br from-purple-900 to-pink-900 rounded-xl p-6 cursor-pointer"
                     onclick="handleSubscriptionSelect('video_course')">
                    <h3 class="text-xl font-bold text-white mb-4">Видеокурс</h3>
                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-purple-400 mr-2"></i>
                            <span>"Освой гитару с нуля за 2 месяца"</span>
                        </li>
                        <li class="flex items-center text-gray-300">
                            <i class="fas fa-check-circle text-purple-400 mr-2"></i>
                            <span>+2 личных урока в подарок</span>
                        </li>
                    </ul>
                    <div class="text-2xl font-bold text-white mb-4">3.990₽</div>
                    <button class="w-full btn-primary py-3 rounded-lg font-semibold">
                        Выбрать <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>

                <!-- Бесплатное занятие -->
                <div class="subscription-card bg-gradient-to-br from-pink-600 to-rose-600 rounded-xl p-6 cursor-pointer pulse"
                     onclick="handleSubscriptionSelect('trial')">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-white">Бесплатное занятие</h3>
                        <span class="bg-white text-pink-600 text-xs font-bold px-2 py-1 rounded-full">NEW</span>
                    </div>
                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center text-gray-100">
                            <i class="fas fa-gift text-white mr-2"></i>
                            <span>Для новых учеников</span>
                        </li>
                        <li class="flex items-center text-gray-100">
                            <i class="fas fa-star text-white mr-2"></i>
                            <span>Познакомьтесь с преподавателем</span>
                        </li>
                    </ul>
                    <div class="text-2xl font-bold text-white mb-4">БЕСПЛАТНО</div>
                    <button class="w-full bg-white text-pink-600 py-3 rounded-lg font-semibold hover:bg-opacity-90 transition">
                        Записаться <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="glass-card rounded-2xl p-8 mb-12 text-center">
            <h2 class="text-3xl font-bold text-white mb-4">Готовы начать свое музыкальное путешествие?</h2>
            <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
                Оставьте заявку и мы подберем для вас идеальный вариант обучения
            </p>
            <button onclick="handleSubscriptionSelect('trial')" 
                    class="btn-primary px-8 py-4 rounded-full text-lg font-bold inline-flex items-center">
                <i class="fas fa-guitar mr-3"></i> Записаться на бесплатный урок
            </button>
        </section>
    </div>

    <!-- Modal -->
    <div class="modal-overlay fixed inset-0 z-50 hidden items-center justify-center p-4" id="modal">
        <div class="modal-content rounded-2xl max-w-md w-full relative overflow-hidden">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-white text-2xl z-10" onclick="closeModal()">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="absolute inset-0 bg-gradient-to-br from-purple-900 to-blue-900 opacity-80"></div>
            
            <div class="relative z-10 p-6" id="modalContent">
                <!-- Content will be inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        const BOT_TOKEN = '7598736914:AAHVJUOt7okTfMh1VE_l1ZrCqaXv-r1PcWI';
        const ADMIN_CHAT_ID = '725158536';
        
        const prices = {
            personal1: {4: 3690, 6: 5290, 8: 6890},
            personal3: {8: 7190, 12: 10490, 16: 13590},
            pair: 2490,
            combo: {nikita: 850, maria: 690, ksenia: 720},
            video_course: 3990,
            trial: 0
        };

        let currentSelection = {
            type: null,
            details: {},
            price: 0
        };

        function handleSubscriptionSelect(type) {
            currentSelection.type = type;
            
            if (['pair', 'video_course', 'trial'].includes(type)) {
                currentSelection.price = prices[type];
                showPaymentScreen();
                return;
            }

            if (type === 'combo') {
                showComboSelection();
                return;
            }

            if (type.includes('personal')) {
                showPersonalOptions(type);
            }
        }

        function showComboSelection() {
            const modalContent = document.getElementById('modalContent');
            modalContent.innerHTML = `
                <div class="text-center mb-6">
                    <h3 class="text-2xl font-bold text-white mb-2">
                        <i class="fas fa-users mr-2"></i>Комбо абонемент
                    </h3>
                    <p class="text-gray-300">Выберите количество занятий с каждым преподавателем</p>
                </div>
                
                <div class="space-y-4 mb-6">
                    ${Object.entries(prices.combo).map(([teacher, price]) => `
                        <div class="glass-card p-4 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-medium text-white capitalize">${teacher}</h4>
                                    <p class="text-sm text-gray-300">${price}₽/урок</p>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <button class="counter-btn bg-purple-600 w-8 h-8 rounded-full text-white flex items-center justify-center hover:bg-purple-700" 
                                            onclick="updateCounter('${teacher}', -1)">
                                        <i class="fas fa-minus text-xs"></i>
                                    </button>
                                    <span id="${teacher}Counter" class="text-white font-medium w-6 text-center">0</span>
                                    <button class="counter-btn bg-purple-600 w-8 h-8 rounded-full text-white flex items-center justify-center hover:bg-purple-700" 
                                            onclick="updateCounter('${teacher}', 1)">
                                        <i class="fas fa-plus text-xs"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="glass-card p-4 rounded-lg mb-6">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-300">Итого:</span>
                        <span id="totalPrice" class="text-xl font-bold text-white">0₽</span>
                    </div>
                </div>
                
                <button onclick="calculateTotalPrice()" 
                        class="w-full btn-primary py-3 rounded-lg font-semibold flex items-center justify-center">
                    Продолжить <i class="fas fa-arrow-right ml-2"></i>
                </button>
            `;
            showModal();
        }

        function updateCounter(teacher, delta) {
            const counter = document.getElementById(`${teacher}Counter`);
            const currentValue = parseInt(counter.textContent) + delta;
            if (currentValue < 0) return;
            counter.textContent = currentValue;
            currentSelection.details[teacher] = currentValue;
            
            // Recalculate total on the fly
            if (Object.values(currentSelection.details).some(v => v > 0)) {
                calculateTotalPrice(true);
            }
        }

        function calculateTotalPrice(dontContinue = false) {
            const total = Object.entries(currentSelection.details)
                .reduce((sum, [teacher, count]) => sum + (count * prices.combo[teacher]), 0);
            
            document.getElementById('totalPrice').textContent = total + '₽';
            
            if (total === 0 && !dontContinue) {
                alert('Пожалуйста, выберите хотя бы одно занятие!');
                return;
            }

            currentSelection.price = total;
            if (!dontContinue) {
                showPaymentScreen();
            }
        }

        function showPersonalOptions(type) {
            const months = type.includes('1') ? '1 месяц' : '2 месяца';
            const modalContent = document.getElementById('modalContent');
            modalContent.innerHTML = `
                <div class="text-center mb-6">
                    <h3 class="text-2xl font-bold text-white mb-2">
                        <i class="fas fa-user mr-2"></i>Личный абонемент
                    </h3>
                    <p class="text-gray-300">${months} • Выберите количество занятий</p>
                </div>
                
                <select id="lessonCount" class="w-full glass-card border border-gray-700 text-white p-3 rounded-lg mb-6 focus:ring-2 focus:ring-purple-500">
                    ${Object.keys(prices[type]).map(count => `
                        <option value="${count}" class="bg-gray-800">${count} занятий - ${prices[type][count]}₽</option>
                    `).join('')}
                </select>
                
                <button onclick="handlePersonalSelection()" 
                        class="w-full btn-primary py-3 rounded-lg font-semibold flex items-center justify-center">
                    Продолжить <i class="fas fa-arrow-right ml-2"></i>
                </button>
            `;
            showModal();
        }

        function handlePersonalSelection() {
            const lessonCount = document.getElementById('lessonCount').value;
            currentSelection.price = prices[currentSelection.type][lessonCount];
            showPaymentScreen();
        }

        function showPaymentScreen() {
            const modalContent = document.getElementById('modalContent');
            modalContent.innerHTML = `
                <div class="text-center mb-6">
                    <h3 class="text-2xl font-bold text-white mb-2">
                        <i class="fas fa-edit mr-2"></i>Оформление заявки
                    </h3>
                    <p class="text-gray-300">Мы свяжемся с вами для подтверждения</p>
                </div>
                
                <div class="mb-6">
                    <label class="block text-gray-300 mb-2">Ваш телефон или Telegram</label>
                    <input type="text" id="contactInput" placeholder="+7 999 123-45-67 или @username" 
                           class="w-full glass-card border border-gray-700 text-white p-3 rounded-lg focus:ring-2 focus:ring-purple-500"
                           autocapitalize="none" autocorrect="off" autocomplete="tel">
                </div>
                
                <div class="glass-card p-4 rounded-lg mb-6">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-300">Сумма к оплате:</span>
                        <span class="text-xl font-bold text-white">${currentSelection.price}₽</span>
                    </div>
                </div>
                
                <button onclick="submitApplication()" 
                        class="w-full btn-primary py-3 rounded-lg font-semibold flex items-center justify-center">
                    Отправить заявку <i class="fas fa-paper-plane ml-2"></i>
                </button>
            `;
            
            // Auto-focus input
            setTimeout(() => {
                document.getElementById('contactInput').focus();
            }, 300);
            
            showModal();
        }

        async function submitApplication() {
            const contact = document.getElementById('contactInput').value.trim();
            if (!contact) {
                alert('Пожалуйста, введите контактные данные!');
                return;
            }

            try {
                let message = `🎸 <b>Новая заявка!</b>\n\n`;
                message += `📌 <b>Тип:</b> ${getSubscriptionName(currentSelection.type)}\n`;
                message += `📞 <b>Контакт:</b> ${contact}\n`;
                message += `💰 <b>Сумма:</b> ${currentSelection.price}₽\n`;

                if (currentSelection.type === 'combo') {
                    message += `\n👨🏫 <b>Распределение занятий:</b>\n`;
                    message += Object.entries(currentSelection.details)
                        .filter(([_, count]) => count > 0)
                        .map(([teacher, count]) => `• ${teacher.charAt(0).toUpperCase() + teacher.slice(1)}: ${count} занятий`)
                        .join('\n');
                }

                if (currentSelection.type.includes('personal')) {
                    const element = document.getElementById('lessonCount');
                    if (element) {
                        const lessons = element.value;
                        message += `\n🎯 <b>Количество занятий:</b> ${lessons}`;
                    }
                }

                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        chat_id: ADMIN_CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });

                if (currentSelection.type === 'trial') {
                    document.getElementById('modalContent').innerHTML = `
                        <div class="text-center py-6">
                            <div class="text-5xl text-green-400 mb-4">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-white mb-4">🎉 Заявка принята!</h3>
                            <p class="text-gray-300 mb-6">Теперь выберите удобное время для занятия:</p>
                            <a href="https://n1328752.yclients.com/company/1196378/personal/menu?o=m3619690s18100919" 
                               target="_blank" 
                               class="block w-full btn-primary py-3 rounded-lg font-semibold mb-4">
                                <i class="fas fa-calendar-alt mr-2"></i> Выбрать время
                            </a>
                            <button onclick="closeModal()" class="w-full btn-secondary py-3 rounded-lg font-semibold">
                                Закрыть <i class="fas fa-times ml-2"></i>
                            </button>
                        </div>
                    `;
                } else {
                    document.getElementById('modalContent').innerHTML = `
                        <div class="text-center py-6">
                            <div class="text-5xl text-green-400 mb-4">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-white mb-4">✅ Заявка отправлена!</h3>
                            <p class="text-gray-300 mb-6">Мы свяжемся с вами в ближайшее время для подтверждения.</p>
                            <button onclick="closeModal()" class="w-full btn-secondary py-3 rounded-lg font-semibold">
                                Закрыть <i class="fas fa-times ml-2"></i>
                            </button>
                        </div>
                    `;
                }

            } catch (error) {
                console.error('Ошибка отправки:', error);
                alert('⚠️ Произошла ошибка при отправке. Пожалуйста, свяжитесь с нами напрямую.');
            }
        }

        function getSubscriptionName(type) {
            const names = {
                trial: 'Бесплатное пробное занятие',
                personal1: 'Личный абонемент (1 месяц)',
                personal3: 'Личный абонемент (2 месяца)',
                pair: 'Парный абонемент',
                combo: 'Комбо абонемент',
                video_course: 'Видеокурс "Освой гитару с нуля"'
            };
            return names[type] || type;
        }

        function showModal() {
            document.getElementById('modal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            document.body.style.overflow = 'auto';
            currentSelection = { type: null, details: {}, price: 0 };
        }

        // Close modal when clicking outside content
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>